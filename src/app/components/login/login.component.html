<div class="login-container">
  <div class="login-card">
    <div class="logo-section">
      <img src="/assets/images/samator.jpg" alt="Samator Logo" class="company-logo" />
      <h1>Sistem Manajemen Truk</h1>
      <p>Silakan login untuk melanjutkan</p>
    </div>
    
    <!-- Loading State -->
    <div class="loading-section" *ngIf="isLoading">
      <div class="loading-spinner"></div>
      <p class="loading-text">Memproses login...</p>
    </div>

    <!-- Login Form -->
    <form (ngSubmit)="onLogin()" class="login-form" *ngIf="!isLoading">
      <div class="form-group">
        <label for="site">Kode Site</label>
        <div class="custom-dropdown" [class.open]="dropdownOpen">
          <div class="dropdown-selected" 
               (click)="toggleDropdown()" 
               [class.error]="errorMessage"
               [class.has-placeholder]="!site">
            <span class="selected-text" 
                  [class.placeholder]="!site">{{ getSelectedPlantText() }}</span>
            <span class="dropdown-arrow">‚ñº</span>
          </div>
          <div class="dropdown-options" *ngIf="dropdownOpen">
            <div class="dropdown-option" 
                 *ngFor="let plant of plants" 
                 [class.selected]="site === plant.Plant"
                 (click)="selectSite(plant.Plant, plant.Plant + ' - ' + plant.Name)">
              <div class="option-code">{{ plant.Plant }}</div>
              <div class="option-name">{{ plant.Name }}</div>
            </div>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="empCode">Kode Karyawan</label>
        <input
          type="text"
          id="empCode"
          [(ngModel)]="empCode"
          name="empCode"
          placeholder="Masukkan kode karyawan Anda"
          required
          [class.error]="errorMessage"
        />
      </div>

      <!-- Current Location Display -->
      <div class="location-section">
        <h4>üìç Lokasi Saat Ini</h4>
        
        <!-- Location Loading -->
        <div class="location-loading" *ngIf="locationLoading">
          <div class="small-spinner"></div>
          <p>Mendeteksi lokasi...</p>
        </div>

        <!-- Location Display -->
        <div class="location-display" *ngIf="currentLocation && !locationLoading">
          <div class="location-item">
            <span class="location-label">Latitude:</span>
            <span class="location-value">{{ formatCoordinate(currentLocation.latitude) }}</span>
          </div>
          <div class="location-item">
            <span class="location-label">Longitude:</span>
            <span class="location-value">{{ formatCoordinate(currentLocation.longitude) }}</span>
          </div>
          <div class="location-item" *ngIf="currentLocation.accuracy">
            <span class="location-label">Akurasi:</span>
            <span class="location-value">{{ currentLocation.accuracy.toFixed(0) }}m</span>
          </div>
        </div>

        <!-- Location Error -->
        <div class="location-error" *ngIf="!currentLocation && !locationLoading">
          <p>‚ùå Lokasi tidak terdeteksi</p>
          <button type="button" class="refresh-btn" (click)="refreshLocation()">
            üîÑ Refresh Lokasi
          </button>
        </div>
      </div>
      
      <button 
        type="submit" 
        class="login-btn" 
        [disabled]="!empCode.trim() || !site.trim() || !currentLocation"
        [class.disabled]="!empCode.trim() || !site.trim() || !currentLocation"
      >
        üöÄ Login
      </button>
    </form>

    <!-- Error Message -->
    <div class="error-alert" *ngIf="errorMessage">
      <p>‚ö†Ô∏è {{ errorMessage }}</p>
    </div>
  </div>
</div>