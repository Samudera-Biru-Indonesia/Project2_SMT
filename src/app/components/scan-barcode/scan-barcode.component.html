<div class="scan-container">
  <app-environment-indicator></app-environment-indicator>
  <header class="header">
    <button class="back-btn" (click)="goBack()">← Kembali</button>
    <h1>Scan Barcode Kendaraan</h1>
  </header>

  <main class="scan-content">
    <div class="scan-card">


      <div class="manual-input-section">
        <h3>Masukkan SPK</h3>
        <form (ngSubmit)="onSubmit()">
          <div class="input-group">
            <input
              type="text"
              [(ngModel)]="barcodeInput"
              name="barcode"
              placeholder="Masukkan barcode kendaraan"
              class="barcode-input"
              [disabled]="isLoadingTripData"
              (input)="onBarcodeInputChange()"
            />
            <div class="input-validation" *ngIf="barcodeInput.trim()">
              <span 
                class="validation-icon" 
                [class.valid]="isValidBarcodeInput()"
                [class.invalid]="!isValidBarcodeInput()"
              >
                {{ isValidBarcodeInput() ? '✅' : '❌' }}
              </span>
              <span class="validation-text">
                {{ isValidBarcodeInput() ? 'Format valid' : 'Format barcode tidak valid' }}
              </span>
            </div>
          </div>
          
          <!-- Loading State -->
          <div class="loading-section" *ngIf="isLoadingTripData">
            <div class="loading-spinner"></div>
            <p class="loading-text">Mengambil data perjalanan...</p>
          </div>
          
          <!-- Error Message -->
          <div class="error-alert" *ngIf="errorMessage">
            <div class="error-content">
              <span class="error-icon">❌</span>
              <div class="error-text">
                <h4>{{ errorTitle }}</h4>
                <p>{{ errorMessage }}</p>
              </div>
              <button class="error-close" (click)="clearError()">×</button>
            </div>
          </div>
          
          <button 
            type="submit" 
            class="submit-btn"
            [disabled]="isLoadingTripData || !barcodeInput.trim()"
          >
            {{ isLoadingTripData ? 'Memuat...' : 'Ambil Data Perjalanan' }}
          </button>
        </form>
      </div>
    </div>
  </main>
</div>
